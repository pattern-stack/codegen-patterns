---
to: "<%= generate.commands ? outputPaths.createCommand : '' %>"
force: true
---
<% if (outputPaths.createCommand) { -%>
/**
 * Create <%= className %> Command
 * Generated by entity codegen - do not edit directly
 *
 * EXTENSION POINTS (add business logic here):
 * - Validation: Add domain validation rules before creating
 * - Defaults: Compute default values not handled by DTO
 * - Side effects: Emit events, send notifications, create related entities
 * - Authorization: Check user permissions beyond route-level auth
 * - Audit: Log creation for compliance/debugging
 */

import { Inject, Injectable } from '@nestjs/common';
import { <%= repositoryToken %> } from '<%= imports.constants %>';
import type { Create<%= className %>Input, I<%= className %>Repository } from '<%= imports.domain %>';
import { <%= className %> } from '<%= imports.domain %>';
import type { Create<%= className %>Dto } from '<%= imports.schemas %>';

@Injectable()
export class <%= createCommandClass %> {
	constructor(
		@Inject(<%= repositoryToken %>)
		private readonly <%= camelName %>Repository: I<%= className %>Repository,
	) {}

	async execute(dto: Create<%= className %>Dto): Promise<<%= className %>> {
		// TODO: Add pre-create validation and business rules here

		// Map DTO to domain input
		const input: Create<%= className %>Input = {
<% fields.forEach((field) => { -%>
<% if (field.required) { -%>
			<%= field.camelName %>: dto.<%= field.camelName %>,
<% } else if (field.nullable) { -%>
			<%= field.camelName %>: dto.<%= field.camelName %> ?? null,
<% } else { -%>
			<%= field.camelName %>: dto.<%= field.camelName %>,
<% } -%>
<% }) -%>
		};

		const created = await this.<%= camelName %>Repository.create(input);

		// TODO: Add post-create side effects here (events, notifications, etc.)

		return created;
	}
}
<% } -%>
