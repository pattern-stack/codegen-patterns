---
to: "<%= generate.queries ? outputPaths.queriesGroupedIndex : '' %>"
force: true
---
<% if (outputPaths.queriesGroupedIndex) { -%>
/**
 * <%= className %> Queries Module
 * Generated by entity codegen - do not edit directly
 *
 * This file contains all query handlers for <%= className %>
 * using grouped file layout (file_grouping: "grouped")
 */

import { Inject, Injectable, NotFoundException } from '@nestjs/common';
import { <%= repositoryToken %> } from '<%= imports.constants %>';
import type { I<%= className %>Repository<%= hasRelationships ? `, ${className}With` : '' %> } from '<%= imports.domain %>';
import { <%= className %> } from '<%= imports.domain %>';

// ============================================================================
// Get <%= className %> By ID Query
// ============================================================================

/**
 * Get <%= className %> By ID Query
 * Generated by entity codegen - do not edit directly
 *
 * EXTENSION POINTS (add query logic here):
 * - Authorization: Check if user can access this specific record
 * - Enrichment: Add computed fields or related data
 * - Caching: Add cache layer for frequently accessed records
 */
@Injectable()
export class Get<%= className %>ByIdQuery {
	constructor(
		@Inject(<%= repositoryToken %>)
		private readonly <%= camelName %>Repository: I<%= className %>Repository,
	) {}

	async execute(id: string<%= hasRelationships ? `, include?: ${className}With` : '' %>): Promise<<%= className %>> {
		// TODO: Add authorization check if needed (row-level security)

		const entity = await this.<%= camelName %>Repository.findById(id<%= hasRelationships ? ', include' : '' %>);
		if (!entity) {
			throw new NotFoundException(`<%= className %> with id ${id} not found`);
		}

		// TODO: Add enrichment or computed fields if needed

		return entity;
	}
}

// ============================================================================
// List <%= classNamePlural %> Query
// ============================================================================

/**
 * List <%= classNamePlural %> Query
 * Generated by entity codegen - do not edit directly
 *
 * EXTENSION POINTS (add query logic here):
 * - Filtering: Add where clauses based on query parameters
 * - Authorization: Filter results based on user permissions (row-level security)
 * - Pagination: Add limit/offset or cursor-based pagination
 * - Sorting: Add order by clauses
 * - Caching: Add cache layer for frequently accessed lists
 */
@Injectable()
export class List<%= classNamePlural %>Query {
	constructor(
		@Inject(<%= repositoryToken %>)
		private readonly <%= camelName %>Repository: I<%= className %>Repository,
	) {}

	async execute(<%= hasRelationships ? `include?: ${className}With` : '' %>): Promise<<%= className %>[]> {
		// TODO: Add filtering, pagination, sorting as needed
		return this.<%= camelName %>Repository.findAll(<%= hasRelationships ? 'include' : '' %>);
	}
}
<% } -%>
