---
to: "<%= generate.structure === 'entity-first' ? `${locations.frontendGenerated.path}/${name}/mutations.ts` : generate.structure === 'concern-first' ? `${locations.frontendGenerated.path}/mutations/${name}.ts` : '' %>"
skip_if: <%= generate.structure === 'monolithic' || !generate.mutations || !(exposeTrpc || exposeRepository) %>
force: true
---
/**
 * <%= className %> Mutations
 * Generated by entity codegen - do not edit directly
 *
 * Optimistic update functions for <%= className %> entity
 */

<% if (generate.structure === 'entity-first') { -%>
import { <%= camelName %>Collection } from './collection';
import type { <%= className %> } from './types';
<% } else if (generate.structure === 'concern-first') { -%>
import { <%= camelName %>Collection } from '../collections/<%= name %>';
import type { <%= className %> } from '../types/<%= name %>';
<% } -%>

export function insert<%= className %>(data: Omit<<%= className %>, 'id'<% if (hasTimestamps) { %> | 'createdAt' | 'updatedAt'<% } %>>) {
	return <%= camelName %>Collection.insert({
		id: crypto.randomUUID(),
<% if (hasTimestamps) { -%>
		createdAt: new Date(),
		updatedAt: new Date(),
<% } -%>
		...data,
	} as <%= className %>);
}

export function update<%= className %>(id: string, fn: (draft: <%= className %>) => void) {
	return <%= camelName %>Collection.update(id, fn);
}

export function delete<%= className %>(id: string) {
	return <%= camelName %>Collection.delete(id);
}
