---
to: <%= locations.frontendStoreEntities.path %>/<%= name %>.ts
skip_if: <%= !generate.hooks %>
force: true
---
/**
 * <%= className %> Entity Hooks
 * Generated by entity codegen - do not edit directly
 *
 * Provides query and mutation hooks for <%= className %> entity.
 */

import { useLiveQuery } from '@tanstack/react-db';
import { eq } from '@tanstack/react-db';
import { <%= camelName %>Collection } from '<%= locations.frontendCollections.import %>/collections';
<%
const entityTypeName = generate.typeNaming === 'plain' ? className : className + 'Entity';
-%>
import type { <%= entityTypeName %> } from '<%= locations.dbEntities.import %>/<%= name %>';

/**
 * Hook to get all <%= plural %>
 */
export function use<%= className %>List() {
	return useLiveQuery((q) => q.from({ <%= camelName %>Collection }), []);
}

/**
 * Hook to get a single <%= camelName %> by ID
 */
export function use<%= className %>ById(id: string | undefined) {
	return useLiveQuery(
		(q) => {
			if (!id) return undefined;
			return q
				.from({ <%= camelName %>Collection })
				.where(({ <%= camelName %>Collection }) => eq(<%= camelName %>Collection.id, id));
		},
		[id],
	);
}

/**
 * Mutation functions for <%= className %>
 */
export const <%= camelName %>Mutations = {
	insert: (data: Omit<<%= entityTypeName %>, 'id' | 'createdAt' | 'updatedAt'> & { id?: string }) => {
		return <%= camelName %>Collection.insert({
			id: data.id ?? crypto.randomUUID(),
			...data,
			createdAt: new Date(),
			updatedAt: new Date(),
		} as <%= entityTypeName %>);
	},

	update: (id: string, updater: (draft: <%= entityTypeName %>) => void) => {
		return <%= camelName %>Collection.update(id, updater);
	},

	delete: (id: string) => {
		return <%= camelName %>Collection.delete(id);
	},
};

/**
 * <%= className %> hooks bundle for store
 */
export const <%= camelName %>Hooks = {
	useList: use<%= className %>List,
	useById: use<%= className %>ById,
	...<%=camelName %>Mutations,
};
