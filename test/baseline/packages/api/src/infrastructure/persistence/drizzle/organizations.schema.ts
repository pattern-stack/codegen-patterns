/**
 * Organization Drizzle Schema
 * Generated by entity codegen - do not edit directly
 */

import { relations } from 'drizzle-orm';
import {
	pgTable,
	uuid,
	varchar,
	index,
} from 'drizzle-orm/pg-core';
import { opportunities } from './opportunities.schema';

export const organizations = pgTable('organizations', {
	id: uuid('id').defaultRandom().primaryKey(),
	tenantId: uuid('tenant_id').notNull(),
	name: varchar('name', { length: 255 }).notNull(),
	domain: varchar('domain', { length: 255 }),
	parentId: uuid('parent_id').references(() => organizations.id),
}, (table) => ({
	parentIdIdx: index('idx_organizations_parent_id').on(table.parentId),
	tenantIdIdx: index('idx_organizations_tenant_id').on(table.tenantId),
	domainIdx: index('idx_organizations_domain').on(table.domain),
	parentIdIdx: index('idx_organizations_parent_id').on(table.parentId),
}));

export const organizationsRelations = relations(organizations, ({ one, many }) => ({
	parent: one(organizations, {
		fields: [organizations.parentId],
		references: [organizations.id],
	}),
	children: many(organizations),
	opportunities: many(opportunities),
}));

export type OrganizationRecord = typeof organizations.$inferSelect;
export type NewOrganizationRecord = typeof organizations.$inferInsert;
