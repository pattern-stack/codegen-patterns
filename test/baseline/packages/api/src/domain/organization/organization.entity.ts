/**
 * Organization Domain Entity
 * Generated by entity codegen - do not edit directly
 *
 * NOTE: Related entity imports assume a nested folder structure where each entity
 * lives in its own folder (e.g., domain/{entity}/{entity}.entity.ts). This follows
 * CLEAN architecture conventions where each aggregate root has its own bounded context.
 * All entities should follow this structure for consistent imports.
 */

import type { Opportunity } from '../opportunity/opportunity.entity';

export class Organization {
	constructor(
		public readonly id: string,
		public readonly tenantId: string,
		public readonly name: string,
		public readonly domain: string | null,
		public readonly parentId: string | null,
		// Loaded relations (optional, populated when eager-loaded)
		public readonly parent?: Organization,
		public readonly children?: Organization[],
		public readonly opportunities?: Opportunity[],
	) {}

	static fromRecord(
		// biome-ignore lint/suspicious/noExplicitAny: Drizzle records have dynamic shape
		record: Record<string, any>,
		// biome-ignore lint/suspicious/noExplicitAny: Returns different entity types
		mapRelation?: (name: string, data: unknown) => any,
	): Organization {
		return new Organization(
			record.id,
			record.tenantId,
			record.name,
			record.domain,
			record.parentId,
			record.parent ? mapRelation?.('parent', record.parent) : undefined,
			record.children ? mapRelation?.('children', record.children) : undefined,
			record.opportunities ? mapRelation?.('opportunities', record.opportunities) : undefined,
		);
	}
}
